# PC Voice Assist 使用指南

## 快速开始

### 安装和配置

首先需要克隆仓库并安装依赖。在终端中执行以下命令完成基础安装:

```bash
git clone https://github.com/Hygge8/PC-Voice-Assist.git
cd PC-Voice-Assist
pip install -r requirements.txt
```

接下来需要配置 OpenAI API Key。您可以通过环境变量的方式设置:

```bash
export OPENAI_API_KEY="your-api-key-here"
```

如果您希望永久保存配置,可以将上述命令添加到 `~/.bashrc` 或 `~/.zshrc` 文件中。

### 首次运行

配置完成后,运行主程序启动语音助手:

```bash
python main.py
```

程序启动时会进行环境噪音校准,这个过程大约需要1-2秒。校准完成后,您会看到提示信息,此时就可以开始说话了。

## 基础功能使用

### 音乐控制

音乐控制功能允许您通过语音命令播放、暂停和停止音乐。首先需要确保音乐文件存放在系统的音乐目录中(默认为 `~/Music`)。

**播放音乐**: 说出"播放音乐"并指定文件路径,例如"播放音乐 /home/user/Music/song.mp3"。系统会加载并播放指定的音乐文件。

**暂停播放**: 当音乐正在播放时,说"暂停音乐"即可暂停当前播放。

**继续播放**: 在暂停状态下,说"继续播放"或"继续音乐"可以恢复播放。

**停止播放**: 说"停止音乐"会完全停止播放并释放音乐资源。

**搜索音乐**: 如果不记得完整的文件路径,可以说"搜索音乐 关键词",系统会在音乐目录中查找包含该关键词的音乐文件。

### AI 写作

AI 写作功能可以根据您指定的主题自动生成文章。系统支持三种文章长度:短文(300-500字)、中等长度(800-1200字)和长文(2000-3000字)。

**基础用法**: 说"帮我写一篇关于人工智能的文章",系统会生成一篇中等长度的文章并保存到默认的文档目录。

**指定长度**: 说"写一篇短文,主题是环保"或"写一篇长文章关于量子计算",系统会根据您的要求生成相应长度的文章。

**指定保存位置**: 说"写一篇关于区块链的文章,保存到桌面",系统会将生成的文章保存到指定位置。

生成的文章采用 Markdown 格式,包含标题、时间戳和正文内容,结构清晰,便于阅读和编辑。

### 文件操作

文件操作功能提供了基本的文件管理能力。出于安全考虑,系统只允许在特定的安全目录内操作文件,包括桌面、文档、下载和音乐目录。

**创建文件**: 说"创建一个文件,路径是 /home/user/Desktop/test.txt,内容是 Hello World",系统会在指定位置创建文件并写入内容。

**读取文件**: 说"读取文件 /home/user/Desktop/test.txt",系统会读取文件内容并通过语音告诉您。为了避免内容过长,系统会自动截断超过1000字符的内容。

**删除文件**: 说"删除文件 /home/user/Desktop/test.txt",系统会删除指定的文件。请注意,删除操作不可恢复,请谨慎使用。

### 应用控制

应用控制功能可以打开常用的应用程序。系统采用白名单机制,只允许打开配置文件中预定义的应用程序。

**打开浏览器**: 说"打开浏览器",系统会启动默认的网页浏览器。

**打开记事本**: 说"打开记事本",系统会启动文本编辑器。

**打开文件管理器**: 说"打开文件管理器",系统会启动系统的文件管理器。

**打开终端**: 说"打开终端",系统会启动命令行终端。

如果需要打开其他应用程序,可以在 `config.py` 文件中添加相应的配置。

### 系统控制

系统控制功能提供了一些系统级的操作。

**音量控制**: 说"增加音量"会提高系统音量10%,说"降低音量"会降低音量10%。您也可以说"把音量设置为50"来设置具体的音量值。

**截图**: 说"截图"或"截屏",系统会捕获当前屏幕并保存到图片目录。截图文件会自动命名为包含时间戳的格式,便于管理。

## 高级功能

### 复杂任务编排

PC Voice Assist 的一大特色是能够理解复杂的指令并自动将其分解为多个步骤执行。这得益于大语言模型的推理能力和 Function Calling 机制。

**示例一**: 说"帮我写一篇关于人工智能的文章,然后保存到桌面,保存完后播放一首轻音乐"。系统会自动执行以下步骤:首先调用写作功能生成文章,然后将文章保存到桌面,最后在音乐目录中搜索轻音乐并播放。

**示例二**: 说"搜索音乐目录中的古典音乐,播放第一首,然后把音量设置为30"。系统会先搜索包含"古典"关键词的音乐文件,选择第一个结果播放,然后调整音量到30%。

**示例三**: 说"在桌面创建一个笔记文件,内容是今天的待办事项,然后打开记事本"。系统会创建文件、写入内容,最后打开记事本方便您编辑。

### 对话上下文

系统会记住最近的对话内容,支持多轮对话。这意味着您可以进行连续的交互而不需要每次都重复上下文。

例如,您可以先说"帮我写一篇关于人工智能的文章",等文章生成后再说"把它保存到桌面",系统会理解"它"指的是刚才生成的文章。

如果您想清空对话历史重新开始,可以说"重置对话"或"清空历史"。

## 配置和定制

### 修改配置文件

打开 `config.py` 文件可以自定义各种参数。

**切换大模型**: 修改 `OPENAI_MODEL` 变量可以切换使用的模型,支持 `gpt-4.1-mini`、`gpt-4.1-nano` 和 `gemini-2.5-flash`。

**调整语音参数**: 修改 `TTS_RATE` 可以调整语音播报的速度,修改 `TTS_VOLUME` 可以调整音量。

**添加应用程序**: 在 `ALLOWED_APPLICATIONS` 字典中添加新的应用程序及其启动命令。

**修改安全目录**: 在 `SAFE_DIRECTORIES` 列表中添加或删除允许进行文件操作的目录。

### 自定义系统提示词

修改 `SYSTEM_PROMPT` 变量可以改变助手的行为和个性。例如,您可以让助手更加正式或更加幽默。

## 常见问题

### 语音识别不准确

如果语音识别经常出错,可以尝试以下方法改善:首先确保麦克风质量良好且距离适中,避免环境噪音过大。其次在程序启动时保持安静,让系统准确校准环境噪音。最后说话时吐字清晰,语速适中。

### 无法播放音乐

确认音乐文件格式是否支持(MP3、WAV、OGG、FLAC、M4A),检查文件路径是否正确,确保文件没有损坏。

### API 调用失败

检查网络连接是否正常,确认 API Key 是否正确设置,查看是否超出了 API 配额限制。

### 语音合成无声音

确认系统音量未静音,检查扬声器是否正常工作,尝试重启程序。

## 命令参考

### 控制命令

- "退出" / "再见" / "结束" - 退出程序
- "重置对话" / "清空历史" - 清空对话历史

### 音乐命令

- "播放音乐 [路径]"
- "暂停音乐"
- "继续播放"
- "停止音乐"
- "搜索音乐 [关键词]"

### 写作命令

- "写一篇关于 [主题] 的文章"
- "写一篇 [短/中/长] 文,主题是 [主题]"
- "写文章关于 [主题],保存到 [路径]"

### 文件命令

- "创建文件 [路径],内容是 [内容]"
- "读取文件 [路径]"
- "删除文件 [路径]"

### 应用命令

- "打开浏览器"
- "打开记事本"
- "打开文件管理器"
- "打开终端"

### 系统命令

- "增加音量"
- "降低音量"
- "把音量设置为 [数值]"
- "截图" / "截屏"

## 最佳实践

在使用过程中,建议采用清晰简洁的语言表达意图,避免使用过于复杂或模糊的表述。对于复杂任务,可以尝试分步骤描述,让系统更准确地理解您的需求。

定期清理对话历史可以提高系统响应速度,特别是在进行长时间使用后。如果发现系统响应变慢或不准确,尝试说"重置对话"重新开始。

在进行文件删除等敏感操作前,建议先确认路径是否正确,避免误删重要文件。虽然系统有安全目录限制,但仍需谨慎操作。

## 故障排除

如果程序无法启动,首先检查 Python 版本是否为 3.11 或更高,确认所有依赖都已正确安装。查看终端输出的错误信息,通常会提示具体的问题所在。

如果遇到权限错误,确保程序有足够的权限访问麦克风、扬声器和文件系统。在 Linux 系统上,可能需要将用户添加到 audio 组。

如果大模型响应异常,检查 API Key 是否有效,网络连接是否稳定,以及是否超出了使用配额。

## 获取帮助

如果遇到本指南未涵盖的问题,可以在 GitHub Issues 中搜索类似问题,或者创建新的 Issue 寻求帮助。在提问时,请提供详细的错误信息、运行环境和复现步骤,这样能够更快地得到解决方案。

